---
/**
 * SectionList.astro
 *
 * Reusable section component for lists like "Education", "Teaching", "Speaking", etc.
 *
 * Props:
 *  - heading: string
 *  - items: Array<{
 *      title: string;
 *      description?: string;
 *      datetime?: string; // value for the `datetime` attribute on <time>
 *      dateLabel?: string; // what to render inside <time>, defaults to `datetime`
 *    }>
 *
 * Slots:
 *  - default: (optional) any extra content to render after the items (e.g. "View all" link)
 */
interface Item {
    title: string;
    description?: string;
    datetime?: string;
    dateLabel?: string;
    href?: string;
    target?: string;
    rel?: string;
    external?: boolean;
}

export interface Props {
    heading: string;
    items: Item[];
}

const heading: string = Astro.props.heading;
const items: Item[] = Astro.props.items ?? [];

function isExternal(href: string) {
    return /^https?:\/\//i.test(href);
}
---

<section>
    <div class="max-w-[90rem] mx-auto px-8">
        <div
            class="grid grid-cols-1 gap-4 md:grid-cols-3 border-b py-8 border-base-200"
        >
            <div class="lg:sticky lg:top-24 lg:z-40 self-start">
                <h2
                    class="text-sm 2xl:text-xl text-base-900 font-bold uppercase"
                >
                    {heading}
                </h2>
            </div>

            <div class="flex flex-col gap-12 lg:col-span-2">
                {
                    items.map((item) => (
                        <article class="group relative grid grid-cols-1 gap-4 lg:grid-cols-3 lg:items-start">
                            <div class="lg:col-span-2">
                                <h3 class="text-sm 2xl:text-xl text-base-900 font-bold uppercase">
                                    {item.href ? (
                                        <a
                                            href={item.href}
                                            target={
                                                item.target ??
                                                ((item.external ??
                                                isExternal(item.href))
                                                    ? "_blank"
                                                    : undefined)
                                            }
                                            rel={
                                                item.rel ??
                                                ((item.external ??
                                                isExternal(item.href))
                                                    ? "noopener noreferrer"
                                                    : undefined)
                                            }
                                        >
                                            <span class="absolute -inset-x-4 -inset-y-6 z-20 sm:-inset-x-6 sm:rounded-2xl" />
                                            <span class="relative z-10">
                                                {item.title}
                                            </span>
                                        </a>
                                    ) : (
                                        item.title
                                    )}
                                </h3>
                                {item.description && (
                                    <p class="text-xs 2xl:text-lg mt-1 text-base-600">
                                        {item.description}
                                    </p>
                                )}
                            </div>

                            {item.datetime && (
                                <p class="text-xs 2xl:text-lg text-base-600 lg:ml-auto">
                                    <time datetime={item.datetime}>
                                        {item.dateLabel ?? item.datetime}
                                    </time>
                                </p>
                            )}
                        </article>
                    ))
                }

                <!-- Slot for optional extra content, e.g. "View all" link -->
                <slot />
            </div>
        </div>
    </div>
</section>
